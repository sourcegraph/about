{"expireTime":9007200905229170000,"key":"transformer-remark-markdown-html-ast-b437d9cdbd45ddc5bc669d9cd989a19a-gatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-unwrap-imagesgatsby-remark-imagesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Liveblog by Beyang Liu (","position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":25,"offset":26}}},{"type":"element","tagName":"a","properties":{"href":"https://twitter.com/beyang"},"children":[{"type":"text","value":"@beyang","position":{"start":{"line":3,"column":26,"offset":27},"end":{"line":3,"column":33,"offset":34}}}],"position":{"start":{"line":3,"column":25,"offset":26},"end":{"line":3,"column":62,"offset":63}}},{"type":"text","value":")","position":{"start":{"line":3,"column":62,"offset":63},"end":{"line":3,"column":63,"offset":64}}}],"position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":63,"offset":64}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://twitter.com/inconshreveable"},"children":[{"type":"text","value":"Alan Shreve","position":{"start":{"line":5,"column":2,"offset":67},"end":{"line":5,"column":13,"offset":78}}}],"position":{"start":{"line":5,"column":1,"offset":66},"end":{"line":5,"column":51,"offset":116}}},{"type":"text","value":" is an hacker, entrepreneur and creator of ngrok.com. ","position":{"start":{"line":5,"column":51,"offset":116},"end":{"line":5,"column":105,"offset":170}}},{"type":"element","tagName":"a","properties":{"href":"https://ngrok.com/"},"children":[{"type":"text","value":"ngrok","position":{"start":{"line":5,"column":106,"offset":171},"end":{"line":5,"column":111,"offset":176}}}],"position":{"start":{"line":5,"column":105,"offset":170},"end":{"line":5,"column":132,"offset":197}}},{"type":"text","value":" is the best way to connect expose services behind a NAT or firewall to the internet for demos, webhook development and IoT connectivity. Today, he’s giving us a whirlwind tour of gRPC and how to use it in your production web service.","position":{"start":{"line":5,"column":132,"offset":197},"end":{"line":5,"column":366,"offset":431}}}],"position":{"start":{"line":5,"column":1,"offset":66},"end":{"line":5,"column":366,"offset":431}}},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[],"position":{"start":{"line":7,"column":1,"offset":433},"end":{"line":7,"column":7,"offset":439}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Q: How do Microservices talk to each other?","position":{"start":{"line":9,"column":1,"offset":441},"end":{"line":9,"column":44,"offset":484}}}],"position":{"start":{"line":9,"column":1,"offset":441},"end":{"line":9,"column":44,"offset":484}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"A: SOAP. Just kidding. Today, it’s mostly HTTP + JSON.","position":{"start":{"line":11,"column":1,"offset":486},"end":{"line":11,"column":55,"offset":540}}}],"position":{"start":{"line":11,"column":1,"offset":486},"end":{"line":11,"column":55,"offset":540}}},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I will die happy if I never write another REST client library in my life.","position":{"start":{"line":13,"column":3,"offset":544},"end":{"line":13,"column":76,"offset":617}}}],"position":{"start":{"line":13,"column":3,"offset":544},"end":{"line":13,"column":76,"offset":617}}},{"type":"text","value":"\n"}],"position":{"start":{"line":13,"column":1,"offset":542},"end":{"line":13,"column":76,"offset":617}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"It’s a lot of repetitive boilerplate.","position":{"start":{"line":15,"column":1,"offset":619},"end":{"line":15,"column":38,"offset":656}}}],"position":{"start":{"line":15,"column":1,"offset":619},"end":{"line":15,"column":38,"offset":656}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"Why-do-REST-APIs-suck","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Why-do-REST-APIs-suck","aria-label":"Why do REST APIs suck permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Why do REST APIs suck?","position":{"start":{"line":17,"column":4,"offset":661},"end":{"line":17,"column":26,"offset":683}}}],"position":{"start":{"line":17,"column":1,"offset":658},"end":{"line":17,"column":26,"offset":683}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Streaming is difficult (nigh-impossible in some languages)","position":{"start":{"line":19,"column":3,"offset":687},"end":{"line":19,"column":61,"offset":745}}}],"position":{"start":{"line":19,"column":1,"offset":685},"end":{"line":19,"column":61,"offset":745}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Bi-directional streaming isn’t possible at all","position":{"start":{"line":20,"column":3,"offset":748},"end":{"line":20,"column":49,"offset":794}}}],"position":{"start":{"line":20,"column":1,"offset":746},"end":{"line":20,"column":49,"offset":794}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Operations are difficult to model (e.g. ‘restart the machine’)","position":{"start":{"line":21,"column":3,"offset":797},"end":{"line":21,"column":65,"offset":859}}}],"position":{"start":{"line":21,"column":1,"offset":795},"end":{"line":21,"column":65,"offset":859}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Inefficient (textual representations aren’t optimal for networks)","position":{"start":{"line":22,"column":3,"offset":862},"end":{"line":22,"column":68,"offset":927}}}],"position":{"start":{"line":22,"column":1,"offset":860},"end":{"line":22,"column":68,"offset":927}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Your internal services aren’t RESTful anyways, they’re just HTTP endpoints","position":{"start":{"line":23,"column":3,"offset":930},"end":{"line":23,"column":77,"offset":1004}}}],"position":{"start":{"line":23,"column":1,"offset":928},"end":{"line":23,"column":77,"offset":1004}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Hard to get many resources in a single request (GraphQL)","position":{"start":{"line":24,"column":3,"offset":1007},"end":{"line":24,"column":59,"offset":1063}}}],"position":{"start":{"line":24,"column":1,"offset":1005},"end":{"line":24,"column":59,"offset":1063}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"No formal (machine-readable) API contract","position":{"start":{"line":25,"column":3,"offset":1066},"end":{"line":25,"column":44,"offset":1107}}}],"position":{"start":{"line":25,"column":3,"offset":1066},"end":{"line":25,"column":44,"offset":1107}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Corollary: writing client libraries requires humans","position":{"start":{"line":26,"column":5,"offset":1112},"end":{"line":26,"column":56,"offset":1163}}}],"position":{"start":{"line":26,"column":5,"offset":1112},"end":{"line":26,"column":56,"offset":1163}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Corollary: humans are expensive and don’t like writing client libraries","position":{"start":{"line":27,"column":10,"offset":1173},"end":{"line":27,"column":81,"offset":1244}}}],"position":{"start":{"line":27,"column":8,"offset":1171},"end":{"line":27,"column":81,"offset":1244}}},{"type":"text","value":"\n"}],"position":{"start":{"line":27,"column":8,"offset":1171},"end":{"line":27,"column":81,"offset":1244}}},{"type":"text","value":"\n"}],"position":{"start":{"line":26,"column":3,"offset":1110},"end":{"line":27,"column":81,"offset":1244}}},{"type":"text","value":"\n"}],"position":{"start":{"line":26,"column":3,"offset":1110},"end":{"line":27,"column":81,"offset":1244}}},{"type":"text","value":"\n"}],"position":{"start":{"line":25,"column":1,"offset":1064},"end":{"line":27,"column":81,"offset":1244}}},{"type":"text","value":"\n"}],"position":{"start":{"line":19,"column":1,"offset":685},"end":{"line":27,"column":81,"offset":1244}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"So-lets-use-gRPC-to-build-a-cache-service","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#So-lets-use-gRPC-to-build-a-cache-service","aria-label":"So lets use gRPC to build a cache service permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"So let’s use gRPC to build a cache service","position":{"start":{"line":32,"column":4,"offset":1252},"end":{"line":32,"column":46,"offset":1294}}}],"position":{"start":{"line":32,"column":1,"offset":1249},"end":{"line":32,"column":46,"offset":1294}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"gRPC is a “high-performance open source universal RPC framework.”","position":{"start":{"line":34,"column":1,"offset":1296},"end":{"line":34,"column":66,"offset":1361}}}],"position":{"start":{"line":34,"column":1,"offset":1296},"end":{"line":34,"column":66,"offset":1361}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let’s build a caching service together using gRPC.","position":{"start":{"line":36,"column":1,"offset":1363},"end":{"line":36,"column":51,"offset":1413}}}],"position":{"start":{"line":36,"column":1,"offset":1363},"end":{"line":36,"column":51,"offset":1413}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We don’t define it in code. We actually define it in an Interface Definition Language (IDL), in this case, protobufs.","position":{"start":{"line":39,"column":1,"offset":1416},"end":{"line":39,"column":118,"offset":1533}}}],"position":{"start":{"line":39,"column":1,"offset":1416},"end":{"line":39,"column":118,"offset":1533}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Here’s our caching service (","position":{"start":{"line":42,"column":1,"offset":1536},"end":{"line":42,"column":29,"offset":1564}}},{"type":"raw","value":"<code class=\"language-text\">app.proto</code>","position":{"start":{"line":42,"column":29,"offset":1564},"end":{"line":42,"column":40,"offset":1575}}},{"type":"text","value":"):","position":{"start":{"line":42,"column":40,"offset":1575},"end":{"line":42,"column":42,"offset":1577}}}],"position":{"start":{"line":42,"column":1,"offset":1536},"end":{"line":42,"column":42,"offset":1577}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\">syntax <span class=\"token operator\">=</span> <span class=\"token string\">\"proto3\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">package</span> rpc<span class=\"token punctuation\">;</span>\nservice Cache <span class=\"token punctuation\">{</span>\n  rpc <span class=\"token function\">Store</span><span class=\"token punctuation\">(</span>StoreReq<span class=\"token punctuation\">)</span> returns <span class=\"token punctuation\">(</span>StoreResp<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  rpc <span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>GetReq<span class=\"token punctuation\">)</span> returns <span class=\"token punctuation\">(</span>GetResp<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\nmessage StoreReq <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">string</span> key <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  bytes val <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nmessage StoreResp <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span>\nmessage GetReq <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">string</span> key <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nmessage GetResp <span class=\"token punctuation\">{</span>\n  bytes val <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":44,"column":1,"offset":1579},"end":{"line":64,"column":4,"offset":1875}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Snap your fingers and now you have client libraries in 9 different languages: C++, Java (including Android), Python, Go, Ruby, C#, JavaScript, Objective-C, PHP.","position":{"start":{"line":68,"column":1,"offset":1879},"end":{"line":68,"column":161,"offset":2039}}}],"position":{"start":{"line":68,"column":1,"offset":1879},"end":{"line":68,"column":161,"offset":2039}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"But wait, there’s more: you also have server stubs for that API in 7 languages: C++, Java, Python, Go, Ruby, C#, JavaScript.","position":{"start":{"line":70,"column":1,"offset":2041},"end":{"line":70,"column":125,"offset":2165}}}],"position":{"start":{"line":70,"column":1,"offset":2041},"end":{"line":70,"column":125,"offset":2165}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We won’t dive into the generated code itself, but let’s see how we can use it.","position":{"start":{"line":72,"column":1,"offset":2167},"end":{"line":72,"column":79,"offset":2245}}}],"position":{"start":{"line":72,"column":1,"offset":2167},"end":{"line":72,"column":79,"offset":2245}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"servergo","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#servergo","aria-label":"servergo permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"server.go","position":{"start":{"line":74,"column":4,"offset":2250},"end":{"line":74,"column":13,"offset":2259}}}],"position":{"start":{"line":74,"column":1,"offset":2247},"end":{"line":74,"column":13,"offset":2259}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let’s look at ","position":{"start":{"line":76,"column":1,"offset":2261},"end":{"line":76,"column":15,"offset":2275}}},{"type":"raw","value":"<code class=\"language-text\">server.go</code>","position":{"start":{"line":76,"column":15,"offset":2275},"end":{"line":76,"column":26,"offset":2286}}},{"type":"text","value":".","position":{"start":{"line":76,"column":26,"offset":2286},"end":{"line":76,"column":27,"offset":2287}}}],"position":{"start":{"line":76,"column":1,"offset":2261},"end":{"line":76,"column":27,"offset":2287}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">serverMain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">:=</span> <span class=\"token function\">runServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Fprintf</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>Stderr<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Failed to run cache server: %s\\n\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n        os<span class=\"token punctuation\">.</span><span class=\"token function\">Exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">func</span> <span class=\"token function\">runServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    srv <span class=\"token operator\">:=</span> grpc<span class=\"token punctuation\">.</span><span class=\"token function\">NewServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    rpc<span class=\"token punctuation\">.</span><span class=\"token function\">RegisterCacheServer</span><span class=\"token punctuation\">(</span>srv<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>CacheService<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    l<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> net<span class=\"token punctuation\">.</span><span class=\"token function\">Listen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tcp\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"localhost:5051\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> err\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// blocks until complete</span>\n    <span class=\"token keyword\">return</span> srv<span class=\"token punctuation\">.</span><span class=\"token function\">Serve</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> CacheService <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">*</span>CacheService<span class=\"token punctuation\">)</span> <span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>ctx context<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">,</span> req <span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>GetReq<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>GetResp<span class=\"token punctuation\">,</span> <span class=\"token builtin\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">,</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unimplemented\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">*</span>CacheService<span class=\"token punctuation\">)</span> <span class=\"token function\">Store</span><span class=\"token punctuation\">(</span>ctx context<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">,</span> req <span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>StoreReq<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>StoreResp<span class=\"token punctuation\">,</span>\n    <span class=\"token builtin\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">,</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unimplemented\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":78,"column":1,"offset":2289},"end":{"line":106,"column":4,"offset":3021}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"clientgo","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#clientgo","aria-label":"clientgo permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"client.go","position":{"start":{"line":114,"column":4,"offset":3032},"end":{"line":114,"column":13,"offset":3041}}}],"position":{"start":{"line":114,"column":1,"offset":3029},"end":{"line":114,"column":13,"offset":3041}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">clientMain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">:=</span> <span class=\"token function\">runClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Fprintf</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>Stderr<span class=\"token punctuation\">,</span> <span class=\"token string\">\"failed: %v\\n\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n        os<span class=\"token punctuation\">.</span><span class=\"token function\">Exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">func</span> <span class=\"token function\">runClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// connnect</span>\n    conn<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> grpc<span class=\"token punctuation\">.</span><span class=\"token function\">Dial</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"localhost:5051\"</span><span class=\"token punctuation\">,</span> grpc<span class=\"token punctuation\">.</span><span class=\"token function\">WithInsecure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to dial server: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    cache <span class=\"token operator\">:=</span> rpc<span class=\"token punctuation\">.</span><span class=\"token function\">NewCacheClient</span><span class=\"token punctuation\">(</span>conn<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// store</span>\n    <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> err <span class=\"token operator\">=</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">Store</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>StoreReq<span class=\"token punctuation\">{</span>Key<span class=\"token punctuation\">:</span> <span class=\"token string\">\"gopher\"</span><span class=\"token punctuation\">,</span> Val<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"con\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to store: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// get</span>\n    resp<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>GetReq<span class=\"token punctuation\">{</span>Key<span class=\"token punctuation\">:</span> <span class=\"token string\">\"gopher\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to get: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Got cached value %s\\n\"</span><span class=\"token punctuation\">,</span> resp<span class=\"token punctuation\">.</span>Val<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":116,"column":1,"offset":3043},"end":{"line":144,"column":4,"offset":3846}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Note: don’t have to write networking code or serialization code.","position":{"start":{"line":150,"column":1,"offset":3852},"end":{"line":150,"column":65,"offset":3916}}}],"position":{"start":{"line":150,"column":1,"offset":3852},"end":{"line":150,"column":65,"offset":3916}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Wait…","position":{"start":{"line":153,"column":1,"offset":3919},"end":{"line":153,"column":8,"offset":3926}}}],"position":{"start":{"line":153,"column":1,"offset":3919},"end":{"line":153,"column":8,"offset":3926}}},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Is this just WSDL all over again?","position":{"start":{"line":155,"column":3,"offset":3930},"end":{"line":155,"column":36,"offset":3963}}}],"position":{"start":{"line":155,"column":3,"offset":3930},"end":{"line":155,"column":36,"offset":3963}}},{"type":"text","value":"\n"}],"position":{"start":{"line":155,"column":1,"offset":3928},"end":{"line":155,"column":36,"offset":3963}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"gRPC-compared-to-SOAPWSDL","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#gRPC-compared-to-SOAPWSDL","aria-label":"gRPC compared to SOAPWSDL permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"gRPC compared to SOAP/WSDL","position":{"start":{"line":157,"column":4,"offset":3968},"end":{"line":157,"column":30,"offset":3994}}}],"position":{"start":{"line":157,"column":1,"offset":3965},"end":{"line":157,"column":30,"offset":3994}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Inextricably tied to XML (grpc is pluggable)","position":{"start":{"line":159,"column":3,"offset":3998},"end":{"line":159,"column":47,"offset":4042}}}],"position":{"start":{"line":159,"column":1,"offset":3996},"end":{"line":159,"column":47,"offset":4042}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Very heavyweight service definition format: XML/XSD nightmare","position":{"start":{"line":160,"column":3,"offset":4045},"end":{"line":160,"column":64,"offset":4106}}}],"position":{"start":{"line":160,"column":1,"offset":4043},"end":{"line":160,"column":64,"offset":4106}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Unnecessarily complex, bloated with unnecessary features (Two-\nphase commit?!)","position":{"start":{"line":161,"column":3,"offset":4109},"end":{"line":162,"column":16,"offset":4187}}}],"position":{"start":{"line":161,"column":1,"offset":4107},"end":{"line":162,"column":16,"offset":4187}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Inflexible and intolerant of forward-compatibility (unlike protobuf)","position":{"start":{"line":163,"column":3,"offset":4190},"end":{"line":163,"column":71,"offset":4258}}}],"position":{"start":{"line":163,"column":1,"offset":4188},"end":{"line":163,"column":71,"offset":4258}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Performance, streaming not solved …","position":{"start":{"line":164,"column":3,"offset":4261},"end":{"line":164,"column":42,"offset":4300}}}],"position":{"start":{"line":164,"column":1,"offset":4259},"end":{"line":164,"column":42,"offset":4300}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Machine-readable API contracts are actually a really great idea","position":{"start":{"line":165,"column":3,"offset":4303},"end":{"line":165,"column":66,"offset":4366}}}],"position":{"start":{"line":165,"column":1,"offset":4301},"end":{"line":165,"column":66,"offset":4366}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Clients were responsible for generating libraries instead of vendors","position":{"start":{"line":166,"column":3,"offset":4369},"end":{"line":166,"column":71,"offset":4437}}}],"position":{"start":{"line":166,"column":1,"offset":4367},"end":{"line":166,"column":71,"offset":4437}}},{"type":"text","value":"\n"}],"position":{"start":{"line":159,"column":1,"offset":3996},"end":{"line":166,"column":71,"offset":4437}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"gRPC-compared-to-Swagger","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#gRPC-compared-to-Swagger","aria-label":"gRPC compared to Swagger permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"gRPC compared to Swagger","position":{"start":{"line":168,"column":5,"offset":4443},"end":{"line":168,"column":29,"offset":4467}}}],"position":{"start":{"line":168,"column":1,"offset":4439},"end":{"line":168,"column":29,"offset":4467}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Solves the machine-readable contract problem, but none\nof the other problems with HTTP/JSON (performance,\nstreaming, modeling)","position":{"start":{"line":170,"column":3,"offset":4471},"end":{"line":172,"column":21,"offset":4597}}}],"position":{"start":{"line":170,"column":1,"offset":4469},"end":{"line":172,"column":21,"offset":4597}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Swagger definitions are cumbersome and incredibly\nverbose. Compared to writing grpc protobuf definitions,\nthey’re a gigantic pain","position":{"start":{"line":173,"column":3,"offset":4600},"end":{"line":175,"column":24,"offset":4729}}}],"position":{"start":{"line":173,"column":1,"offset":4598},"end":{"line":175,"column":24,"offset":4729}}},{"type":"text","value":"\n"}],"position":{"start":{"line":170,"column":1,"offset":4469},"end":{"line":175,"column":24,"offset":4729}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"gRPC-compared-to-Thrift","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#gRPC-compared-to-Thrift","aria-label":"gRPC compared to Thrift permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"gRPC compared to Thrift","position":{"start":{"line":177,"column":5,"offset":4735},"end":{"line":177,"column":28,"offset":4758}}}],"position":{"start":{"line":177,"column":1,"offset":4731},"end":{"line":177,"column":28,"offset":4758}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Thrift actually a really great idea, very similar project goals","position":{"start":{"line":179,"column":3,"offset":4762},"end":{"line":179,"column":66,"offset":4825}}}],"position":{"start":{"line":179,"column":1,"offset":4760},"end":{"line":179,"column":66,"offset":4825}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Never achieved same ubiquity and ease of use. This is really hard. Requires all major language implementations to be:","position":{"start":{"line":180,"column":3,"offset":4828},"end":{"line":180,"column":120,"offset":4945}}}],"position":{"start":{"line":180,"column":3,"offset":4828},"end":{"line":180,"column":120,"offset":4945}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"well documented","position":{"start":{"line":181,"column":5,"offset":4950},"end":{"line":181,"column":20,"offset":4965}}}],"position":{"start":{"line":181,"column":3,"offset":4948},"end":{"line":181,"column":20,"offset":4965}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"reliable","position":{"start":{"line":182,"column":5,"offset":4970},"end":{"line":182,"column":13,"offset":4978}}}],"position":{"start":{"line":182,"column":3,"offset":4968},"end":{"line":182,"column":13,"offset":4978}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"highly performant","position":{"start":{"line":183,"column":5,"offset":4983},"end":{"line":183,"column":22,"offset":5000}}}],"position":{"start":{"line":183,"column":3,"offset":4981},"end":{"line":183,"column":22,"offset":5000}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"easy to install","position":{"start":{"line":184,"column":5,"offset":5005},"end":{"line":184,"column":20,"offset":5020}}}],"position":{"start":{"line":184,"column":3,"offset":5003},"end":{"line":184,"column":20,"offset":5020}}},{"type":"text","value":"\n"}],"position":{"start":{"line":181,"column":3,"offset":4948},"end":{"line":184,"column":20,"offset":5020}}},{"type":"text","value":"\n"}],"position":{"start":{"line":180,"column":1,"offset":4826},"end":{"line":184,"column":20,"offset":5020}}},{"type":"text","value":"\n"}],"position":{"start":{"line":179,"column":1,"offset":4760},"end":{"line":184,"column":20,"offset":5020}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Implementing-the-methods","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Implementing-the-methods","aria-label":"Implementing the methods permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Implementing the methods","position":{"start":{"line":196,"column":5,"offset":5036},"end":{"line":196,"column":29,"offset":5060}}}],"position":{"start":{"line":196,"column":1,"offset":5032},"end":{"line":196,"column":29,"offset":5060}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let’s fill in the stubs that gRPC generated for us:","position":{"start":{"line":198,"column":1,"offset":5062},"end":{"line":198,"column":52,"offset":5113}}}],"position":{"start":{"line":198,"column":1,"offset":5062},"end":{"line":198,"column":52,"offset":5113}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> CacheService <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n    store <span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">byte</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">*</span>CacheService<span class=\"token punctuation\">)</span> <span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>ctx context<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">,</span> req <span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>GetReq<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>GetResp<span class=\"token punctuation\">,</span>\n    <span class=\"token builtin\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    val <span class=\"token operator\">:=</span> s<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">[</span>req<span class=\"token punctuation\">.</span>Key<span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>GetResp<span class=\"token punctuation\">{</span>Val<span class=\"token punctuation\">:</span> val<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">nil</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">*</span>CacheService<span class=\"token punctuation\">)</span> <span class=\"token function\">Store</span><span class=\"token punctuation\">(</span>ctx context<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">,</span> req <span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>StoreReq<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>StoreResp<span class=\"token punctuation\">,</span> <span class=\"token builtin\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    s<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">[</span>req<span class=\"token punctuation\">.</span>Key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>Val\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>StoreResp<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">nil</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":200,"column":1,"offset":5115},"end":{"line":214,"column":4,"offset":5504}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"gRPC-errors","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#gRPC-errors","aria-label":"gRPC errors permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"gRPC errors","position":{"start":{"line":218,"column":5,"offset":5512},"end":{"line":218,"column":16,"offset":5523}}}],"position":{"start":{"line":218,"column":1,"offset":5508},"end":{"line":218,"column":16,"offset":5523}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"There’s a number of error codes each corresponding to types of errors. It’s kind of like HTTP errors, but no response body.","position":{"start":{"line":220,"column":1,"offset":5525},"end":{"line":220,"column":124,"offset":5648}}}],"position":{"start":{"line":220,"column":1,"offset":5525},"end":{"line":220,"column":124,"offset":5648}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">*</span>CacheService<span class=\"token punctuation\">)</span> <span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>ctx context<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">,</span> req <span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>GetReq<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>GetResp<span class=\"token punctuation\">,</span> <span class=\"token builtin\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    val<span class=\"token punctuation\">,</span> ok <span class=\"token operator\">:=</span> s<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">[</span>req<span class=\"token punctuation\">.</span>Key<span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">if</span> <span class=\"token operator\">!</span>ok <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">,</span> status<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span>codes<span class=\"token punctuation\">.</span>NotFound<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Key not found %s\"</span><span class=\"token punctuation\">,</span>\n            req<span class=\"token punctuation\">.</span>Key<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>GetResp<span class=\"token punctuation\">{</span>Val<span class=\"token punctuation\">:</span> val<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">nil</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":222,"column":1,"offset":5650},"end":{"line":231,"column":4,"offset":5931}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Secure-transport","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Secure-transport","aria-label":"Secure transport permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Secure transport","position":{"start":{"line":235,"column":5,"offset":5939},"end":{"line":235,"column":21,"offset":5955}}}],"position":{"start":{"line":235,"column":1,"offset":5935},"end":{"line":235,"column":21,"offset":5955}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"There’s a simple API for that. On the server:","position":{"start":{"line":237,"column":1,"offset":5957},"end":{"line":237,"column":46,"offset":6002}}}],"position":{"start":{"line":237,"column":1,"offset":5957},"end":{"line":237,"column":46,"offset":6002}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">runServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    tlsCreds<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> credentials<span class=\"token punctuation\">.</span><span class=\"token function\">NewServerTLSFromFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tls.crt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tls.key\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> err\n    <span class=\"token punctuation\">}</span>\n    srv <span class=\"token operator\">:=</span> grpc<span class=\"token punctuation\">.</span><span class=\"token function\">NewServer</span><span class=\"token punctuation\">(</span>grpc<span class=\"token punctuation\">.</span><span class=\"token function\">Creds</span><span class=\"token punctuation\">(</span>tlsCreds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    rpc<span class=\"token punctuation\">.</span><span class=\"token function\">RegisterCacheServer</span><span class=\"token punctuation\">(</span>srv<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>CacheService<span class=\"token punctuation\">{</span><span class=\"token function\">make</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">byte</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    l<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> net<span class=\"token punctuation\">.</span><span class=\"token function\">Listen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tcp\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"localhost:5051\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> err\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> srv<span class=\"token punctuation\">.</span><span class=\"token function\">Serve</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":239,"column":1,"offset":6004},"end":{"line":253,"column":4,"offset":6401}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"On the client:","position":{"start":{"line":255,"column":1,"offset":6403},"end":{"line":255,"column":15,"offset":6417}}}],"position":{"start":{"line":255,"column":1,"offset":6403},"end":{"line":255,"column":15,"offset":6417}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">runClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// connect</span>\n    <span class=\"token comment\">// InsecureSkipVerify only for this example</span>\n    tlsCreds <span class=\"token operator\">:=</span> credentials<span class=\"token punctuation\">.</span><span class=\"token function\">NewTLS</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>tls<span class=\"token punctuation\">.</span>Config<span class=\"token punctuation\">{</span>InsecureSkipVerify<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    conn<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> grpc<span class=\"token punctuation\">.</span><span class=\"token function\">Dial</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"localhost:5051\"</span><span class=\"token punctuation\">,</span> grpc<span class=\"token punctuation\">.</span><span class=\"token function\">WithTransportCredentials</span><span class=\"token punctuation\">(</span>tlsCreds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to dial server: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":257,"column":1,"offset":6419},"end":{"line":267,"column":4,"offset":6763}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Whats-going-on-underneath-the-hood-How-does-it-work","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Whats-going-on-underneath-the-hood-How-does-it-work","aria-label":"Whats going on underneath the hood How does it work permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"What’s going on underneath the hood? How does it work?","position":{"start":{"line":272,"column":5,"offset":6772},"end":{"line":272,"column":59,"offset":6826}}}],"position":{"start":{"line":272,"column":1,"offset":6768},"end":{"line":272,"column":59,"offset":6826}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"protobuf serialized over HTTP/2:","position":{"start":{"line":274,"column":1,"offset":6828},"end":{"line":274,"column":33,"offset":6860}}}],"position":{"start":{"line":274,"column":1,"offset":6828},"end":{"line":274,"column":33,"offset":6860}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"HTTP/2","position":{"start":{"line":276,"column":3,"offset":6864},"end":{"line":276,"column":9,"offset":6870}}}],"position":{"start":{"line":276,"column":1,"offset":6862},"end":{"line":276,"column":9,"offset":6870}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"protobuf serialization (pluggable)","position":{"start":{"line":277,"column":3,"offset":6873},"end":{"line":277,"column":37,"offset":6907}}}],"position":{"start":{"line":277,"column":1,"offset":6871},"end":{"line":277,"column":37,"offset":6907}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Clients open one long-lived connection to a grpc server","position":{"start":{"line":278,"column":3,"offset":6910},"end":{"line":278,"column":58,"offset":6965}}}],"position":{"start":{"line":278,"column":3,"offset":6910},"end":{"line":278,"column":58,"offset":6965}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"A new HTTP/2 stream for each RPC call","position":{"start":{"line":279,"column":5,"offset":6970},"end":{"line":279,"column":42,"offset":7007}}}],"position":{"start":{"line":279,"column":3,"offset":6968},"end":{"line":279,"column":42,"offset":7007}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Allows simultaneous in-flight RPC calls","position":{"start":{"line":280,"column":5,"offset":7012},"end":{"line":280,"column":44,"offset":7051}}}],"position":{"start":{"line":280,"column":3,"offset":7010},"end":{"line":280,"column":44,"offset":7051}}},{"type":"text","value":"\n"}],"position":{"start":{"line":279,"column":3,"offset":6968},"end":{"line":280,"column":44,"offset":7051}}},{"type":"text","value":"\n"}],"position":{"start":{"line":278,"column":1,"offset":6908},"end":{"line":280,"column":44,"offset":7051}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Allows client-side and server-side streaming","position":{"start":{"line":281,"column":3,"offset":7054},"end":{"line":281,"column":47,"offset":7098}}}],"position":{"start":{"line":281,"column":1,"offset":7052},"end":{"line":281,"column":47,"offset":7098}}},{"type":"text","value":"\n"}],"position":{"start":{"line":276,"column":1,"offset":6862},"end":{"line":281,"column":47,"offset":7098}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Implementations","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Implementations","aria-label":"Implementations permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Implementations","position":{"start":{"line":285,"column":5,"offset":7106},"end":{"line":285,"column":20,"offset":7121}}}],"position":{"start":{"line":285,"column":1,"offset":7102},"end":{"line":285,"column":20,"offset":7121}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"There are 3 implementations at the moment:","position":{"start":{"line":287,"column":1,"offset":7123},"end":{"line":287,"column":43,"offset":7165}}}],"position":{"start":{"line":287,"column":1,"offset":7123},"end":{"line":287,"column":43,"offset":7165}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Three high-performance event loop driven implementations","position":{"start":{"line":290,"column":3,"offset":7170},"end":{"line":290,"column":59,"offset":7226}}}],"position":{"start":{"line":290,"column":1,"offset":7168},"end":{"line":290,"column":59,"offset":7226}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"C","position":{"start":{"line":291,"column":3,"offset":7229},"end":{"line":291,"column":4,"offset":7230}}}],"position":{"start":{"line":291,"column":3,"offset":7229},"end":{"line":291,"column":4,"offset":7230}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Ruby, Python, node.js, PHP, C#, Objective-C, and C++ are all bindings to the “C\ncore”","position":{"start":{"line":292,"column":5,"offset":7235},"end":{"line":293,"column":6,"offset":7320}}}],"position":{"start":{"line":292,"column":3,"offset":7233},"end":{"line":293,"column":6,"offset":7320}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"PHP via PECL extension (apache or nginx/php-fpm)","position":{"start":{"line":294,"column":5,"offset":7325},"end":{"line":294,"column":53,"offset":7373}}}],"position":{"start":{"line":294,"column":3,"offset":7323},"end":{"line":294,"column":53,"offset":7373}}},{"type":"text","value":"\n"}],"position":{"start":{"line":292,"column":3,"offset":7233},"end":{"line":294,"column":53,"offset":7373}}},{"type":"text","value":"\n"}],"position":{"start":{"line":291,"column":1,"offset":7227},"end":{"line":294,"column":53,"offset":7373}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Java","position":{"start":{"line":295,"column":3,"offset":7376},"end":{"line":295,"column":7,"offset":7380}}}],"position":{"start":{"line":295,"column":3,"offset":7376},"end":{"line":295,"column":7,"offset":7380}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Netty + BoringSSL via JNI","position":{"start":{"line":296,"column":5,"offset":7385},"end":{"line":296,"column":30,"offset":7410}}}],"position":{"start":{"line":296,"column":3,"offset":7383},"end":{"line":296,"column":30,"offset":7410}}},{"type":"text","value":"\n"}],"position":{"start":{"line":296,"column":3,"offset":7383},"end":{"line":296,"column":30,"offset":7410}}},{"type":"text","value":"\n"}],"position":{"start":{"line":295,"column":1,"offset":7374},"end":{"line":296,"column":30,"offset":7410}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Go","position":{"start":{"line":297,"column":3,"offset":7413},"end":{"line":297,"column":5,"offset":7415}}}],"position":{"start":{"line":297,"column":3,"offset":7413},"end":{"line":297,"column":5,"offset":7415}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Pure Go implementation using Go stdlib crypto/tls package","position":{"start":{"line":298,"column":5,"offset":7420},"end":{"line":298,"column":62,"offset":7477}}}],"position":{"start":{"line":298,"column":3,"offset":7418},"end":{"line":298,"column":62,"offset":7477}}},{"type":"text","value":"\n"}],"position":{"start":{"line":298,"column":3,"offset":7418},"end":{"line":298,"column":62,"offset":7477}}},{"type":"text","value":"\n"}],"position":{"start":{"line":297,"column":1,"offset":7411},"end":{"line":298,"column":62,"offset":7477}}},{"type":"text","value":"\n"}],"position":{"start":{"line":290,"column":1,"offset":7168},"end":{"line":298,"column":62,"offset":7477}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Where-did-gRPC-come-from","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Where-did-gRPC-come-from","aria-label":"Where did gRPC come from permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Where did gRPC come from?","position":{"start":{"line":302,"column":5,"offset":7485},"end":{"line":302,"column":30,"offset":7510}}}],"position":{"start":{"line":302,"column":1,"offset":7481},"end":{"line":302,"column":30,"offset":7510}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Originally pioneered by a team at Google","position":{"start":{"line":304,"column":3,"offset":7514},"end":{"line":304,"column":43,"offset":7554}}}],"position":{"start":{"line":304,"column":1,"offset":7512},"end":{"line":304,"column":43,"offset":7554}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Next generation version of an internal Google project\ncalled ‘stubby’","position":{"start":{"line":305,"column":3,"offset":7557},"end":{"line":306,"column":16,"offset":7626}}}],"position":{"start":{"line":305,"column":1,"offset":7555},"end":{"line":306,"column":16,"offset":7626}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now a F/OSS project with a completely open spec and\ncontributors from many companies","position":{"start":{"line":307,"column":3,"offset":7629},"end":{"line":308,"column":33,"offset":7713}}}],"position":{"start":{"line":307,"column":3,"offset":7629},"end":{"line":308,"column":33,"offset":7713}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Development is still primarily executed by Google devs","position":{"start":{"line":309,"column":5,"offset":7718},"end":{"line":309,"column":59,"offset":7772}}}],"position":{"start":{"line":309,"column":3,"offset":7716},"end":{"line":309,"column":59,"offset":7772}}},{"type":"text","value":"\n"}],"position":{"start":{"line":309,"column":3,"offset":7716},"end":{"line":309,"column":59,"offset":7772}}},{"type":"text","value":"\n"}],"position":{"start":{"line":307,"column":1,"offset":7627},"end":{"line":309,"column":59,"offset":7772}}},{"type":"text","value":"\n"}],"position":{"start":{"line":304,"column":1,"offset":7512},"end":{"line":309,"column":59,"offset":7772}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"What-if-you-have-misbehaving-clients","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#What-if-you-have-misbehaving-clients","aria-label":"What if you have misbehaving clients permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"What if you have misbehaving clients","position":{"start":{"line":312,"column":5,"offset":7779},"end":{"line":312,"column":41,"offset":7815}}}],"position":{"start":{"line":312,"column":1,"offset":7775},"end":{"line":312,"column":41,"offset":7815}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let’s try Multitenancy (associating client ID with each request):","position":{"start":{"line":314,"column":1,"offset":7817},"end":{"line":314,"column":66,"offset":7882}}}],"position":{"start":{"line":314,"column":1,"offset":7817},"end":{"line":314,"column":66,"offset":7882}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\">message StoreReq <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">string</span> key <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  bytes val <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n  <span class=\"token builtin\">string</span> account_token <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;-- woo!</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":316,"column":1,"offset":7884},"end":{"line":322,"column":4,"offset":7989}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">app.proto</code>","position":{"start":{"line":324,"column":1,"offset":7991},"end":{"line":324,"column":12,"offset":8002}}},{"type":"text","value":":","position":{"start":{"line":324,"column":12,"offset":8002},"end":{"line":324,"column":13,"offset":8003}}}],"position":{"start":{"line":324,"column":1,"offset":7991},"end":{"line":324,"column":13,"offset":8003}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\">service Accounts <span class=\"token punctuation\">{</span>\n  rpc <span class=\"token function\">GetByToken</span><span class=\"token punctuation\">(</span>GetByTokenReq<span class=\"token punctuation\">)</span> returns <span class=\"token punctuation\">(</span>GetByTokenResp<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\nmessage GetByTokenReq <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">string</span> token <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nmessage GetByTokenResp <span class=\"token punctuation\">{</span>\n  Account account <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nmessage Account <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">int64</span> max_cache_keys <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":326,"column":1,"offset":8005},"end":{"line":339,"column":4,"offset":8239}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">client.go</code>","position":{"start":{"line":341,"column":1,"offset":8241},"end":{"line":341,"column":12,"offset":8252}}},{"type":"text","value":":","position":{"start":{"line":341,"column":12,"offset":8252},"end":{"line":341,"column":13,"offset":8253}}}],"position":{"start":{"line":341,"column":1,"offset":8241},"end":{"line":341,"column":13,"offset":8253}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">runClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    cache <span class=\"token operator\">:=</span> rpc<span class=\"token punctuation\">.</span><span class=\"token function\">NewCacheClient</span><span class=\"token punctuation\">(</span>conn<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// store</span>\n    <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> err <span class=\"token operator\">=</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">Store</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>StoreReq<span class=\"token punctuation\">{</span>\n        AccountToken<span class=\"token punctuation\">:</span> <span class=\"token string\">\"inconshreveable\"</span><span class=\"token punctuation\">,</span>\n    Key<span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"gopher\"</span><span class=\"token punctuation\">,</span>\n    Val<span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"con\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to store: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// get</span>\n    resp<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>GetReq<span class=\"token punctuation\">{</span>Key<span class=\"token punctuation\">:</span> <span class=\"token string\">\"gopher\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to get: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":343,"column":1,"offset":8255},"end":{"line":363,"column":4,"offset":8757}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">server.go</code>","position":{"start":{"line":365,"column":1,"offset":8759},"end":{"line":365,"column":12,"offset":8770}}},{"type":"text","value":":","position":{"start":{"line":365,"column":12,"offset":8770},"end":{"line":365,"column":13,"offset":8771}}}],"position":{"start":{"line":365,"column":1,"offset":8759},"end":{"line":365,"column":13,"offset":8771}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> CacheService <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n    accounts      rpc<span class=\"token punctuation\">.</span>AccountsClient\n    store         <span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">byte</span>\n    keysByAccount <span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">int64</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">*</span>CacheService<span class=\"token punctuation\">)</span> <span class=\"token function\">Store</span><span class=\"token punctuation\">(</span>ctx context<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">,</span> req <span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>StoreReq<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>StoreResp<span class=\"token punctuation\">,</span> <span class=\"token builtin\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    resp<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> s<span class=\"token punctuation\">.</span>accounts<span class=\"token punctuation\">.</span><span class=\"token function\">GetByToken</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>GetByTokenReq<span class=\"token punctuation\">{</span>\n        Token<span class=\"token punctuation\">:</span> req<span class=\"token punctuation\">.</span>AccountToken<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">,</span> err\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> s<span class=\"token punctuation\">.</span>keysByAccount<span class=\"token punctuation\">[</span>req<span class=\"token punctuation\">.</span>AccountToken<span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> resp<span class=\"token punctuation\">.</span>Account<span class=\"token punctuation\">.</span>MaxCacheKeys <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">,</span> status<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span>codes<span class=\"token punctuation\">.</span>FailedPrecondition<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Account %s exceeds max key limit %d\"</span><span class=\"token punctuation\">,</span> req<span class=\"token punctuation\">.</span>A$\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> ok <span class=\"token operator\">:=</span> s<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">[</span>req<span class=\"token punctuation\">.</span>Key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">!</span>ok <span class=\"token punctuation\">{</span>\n        s<span class=\"token punctuation\">.</span>keysByAccount<span class=\"token punctuation\">[</span>req<span class=\"token punctuation\">.</span>AccountToken<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n    s<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">[</span>req<span class=\"token punctuation\">.</span>Key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>Val\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>StoreResp<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">nil</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":367,"column":1,"offset":8773},"end":{"line":391,"column":4,"offset":9530}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Its-too-slow","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Its-too-slow","aria-label":"Its too slow permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"“It’s too slow”","position":{"start":{"line":399,"column":5,"offset":9542},"end":{"line":399,"column":20,"offset":9557}}}],"position":{"start":{"line":399,"column":1,"offset":9538},"end":{"line":399,"column":20,"offset":9557}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now someone tells you your service is too slow. And here you realize you have no visibility. What do you do?","position":{"start":{"line":401,"column":1,"offset":9559},"end":{"line":401,"column":109,"offset":9667}}}],"position":{"start":{"line":401,"column":1,"offset":9559},"end":{"line":401,"column":109,"offset":9667}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Option 1: add logging:","position":{"start":{"line":403,"column":1,"offset":9669},"end":{"line":403,"column":23,"offset":9691}}}],"position":{"start":{"line":403,"column":1,"offset":9669},"end":{"line":403,"column":23,"offset":9691}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">client.go</code>","position":{"start":{"line":405,"column":1,"offset":9693},"end":{"line":405,"column":12,"offset":9704}}},{"type":"text","value":":","position":{"start":{"line":405,"column":12,"offset":9704},"end":{"line":405,"column":13,"offset":9705}}}],"position":{"start":{"line":405,"column":1,"offset":9693},"end":{"line":405,"column":13,"offset":9705}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">runClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// store</span>\n    start <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// &lt;==</span>\n    <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> err <span class=\"token operator\">=</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">Store</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>StoreReq<span class=\"token punctuation\">{</span>\n        AccountToken<span class=\"token punctuation\">:</span> <span class=\"token string\">\"inconshreveable\"</span><span class=\"token punctuation\">,</span>\n    Key<span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"gopher\"</span><span class=\"token punctuation\">,</span>\n    Val<span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"con\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cache.Store duration %s\"</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Since</span><span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to store: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// get</span>\n    start <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">// &lt;==</span>\n    resp<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>GetReq<span class=\"token punctuation\">{</span>Key<span class=\"token punctuation\">:</span> <span class=\"token string\">\"gopher\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cache.Get duration %s\"</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Since</span><span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// &lt;==</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to get: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":407,"column":1,"offset":9707},"end":{"line":431,"column":4,"offset":10361}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">server.go</code>","position":{"start":{"line":433,"column":1,"offset":10363},"end":{"line":433,"column":12,"offset":10374}}},{"type":"text","value":":","position":{"start":{"line":433,"column":12,"offset":10374},"end":{"line":433,"column":13,"offset":10375}}}],"position":{"start":{"line":433,"column":1,"offset":10363},"end":{"line":433,"column":13,"offset":10375}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">*</span>CacheService<span class=\"token punctuation\">)</span> <span class=\"token function\">Store</span><span class=\"token punctuation\">(</span>ctx context<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">,</span> req <span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>StoreReq<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>StoreResp<span class=\"token punctuation\">,</span> <span class=\"token builtin\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    start <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    resp<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> s<span class=\"token punctuation\">.</span>accounts<span class=\"token punctuation\">.</span><span class=\"token function\">GetByToken</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>GetByTokenReq<span class=\"token punctuation\">{</span>\n        Token<span class=\"token punctuation\">:</span> req<span class=\"token punctuation\">.</span>AccountToken<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"accounts.GetByToken duration %s\"</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Since</span><span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">,</span> err\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":435,"column":1,"offset":10377},"end":{"line":447,"column":4,"offset":10748}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Note: this is a lot of boilerplate. Turns out gRPC has something for that: the client interceptor. Every time you make a remote call, the interceptor middleware will be invoked.","position":{"start":{"line":457,"column":1,"offset":10758},"end":{"line":457,"column":178,"offset":10935}}}],"position":{"start":{"line":457,"column":1,"offset":10758},"end":{"line":457,"column":178,"offset":10935}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Client-interceptor","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Client-interceptor","aria-label":"Client interceptor permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Client interceptor","position":{"start":{"line":460,"column":5,"offset":10942},"end":{"line":460,"column":23,"offset":10960}}}],"position":{"start":{"line":460,"column":1,"offset":10938},"end":{"line":460,"column":23,"offset":10960}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">interceptor.go</code>","position":{"start":{"line":462,"column":1,"offset":10962},"end":{"line":462,"column":17,"offset":10978}}},{"type":"text","value":":","position":{"start":{"line":462,"column":17,"offset":10978},"end":{"line":462,"column":18,"offset":10979}}}],"position":{"start":{"line":462,"column":1,"offset":10962},"end":{"line":462,"column":18,"offset":10979}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">WithClientInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> grpc<span class=\"token punctuation\">.</span>DialOption <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> grpc<span class=\"token punctuation\">.</span><span class=\"token function\">WithUnaryInterceptor</span><span class=\"token punctuation\">(</span>clientInterceptor<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">func</span> <span class=\"token function\">clientInterceptor</span><span class=\"token punctuation\">(</span>\n    ctx context<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">,</span>\n    method <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span>\n    req <span class=\"token keyword\">interface</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    reply <span class=\"token keyword\">interface</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    cc <span class=\"token operator\">*</span>grpc<span class=\"token punctuation\">.</span>ClientConn<span class=\"token punctuation\">,</span>\n    invoker grpc<span class=\"token punctuation\">.</span>UnaryInvoker<span class=\"token punctuation\">,</span>\n    opts <span class=\"token operator\">...</span>grpc<span class=\"token punctuation\">.</span>CallOption<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    start <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    err <span class=\"token operator\">:=</span> <span class=\"token function\">invoker</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> method<span class=\"token punctuation\">,</span> req<span class=\"token punctuation\">,</span> reply<span class=\"token punctuation\">,</span> cc<span class=\"token punctuation\">,</span> opts<span class=\"token operator\">...</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// &lt;==</span>\n    log<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"invoke remote method=%s duration=%s error=%v\"</span><span class=\"token punctuation\">,</span> method<span class=\"token punctuation\">,</span>\n        time<span class=\"token punctuation\">.</span><span class=\"token function\">Since</span><span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> err\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":464,"column":1,"offset":10981},"end":{"line":483,"column":4,"offset":11510}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">client.go</code>","position":{"start":{"line":486,"column":1,"offset":11513},"end":{"line":486,"column":12,"offset":11524}}},{"type":"text","value":":","position":{"start":{"line":486,"column":12,"offset":11524},"end":{"line":486,"column":13,"offset":11525}}}],"position":{"start":{"line":486,"column":1,"offset":11513},"end":{"line":486,"column":13,"offset":11525}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">runClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// connnect</span>\n    tlsCreds <span class=\"token operator\">:=</span> credentials<span class=\"token punctuation\">.</span><span class=\"token function\">NewTLS</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>tls<span class=\"token punctuation\">.</span>Config<span class=\"token punctuation\">{</span>InsecureSkipVerify<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    conn<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> grpc<span class=\"token punctuation\">.</span><span class=\"token function\">Dial</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"localhost:5051\"</span><span class=\"token punctuation\">,</span>\n        grpc<span class=\"token punctuation\">.</span><span class=\"token function\">WithTransportCredentials</span><span class=\"token punctuation\">(</span>tlsCreds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">WithClientInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// &lt;==</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to dial server: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":488,"column":1,"offset":11527},"end":{"line":500,"column":4,"offset":11874}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">server.go</code>","position":{"start":{"line":502,"column":1,"offset":11876},"end":{"line":502,"column":12,"offset":11887}}},{"type":"text","value":":","position":{"start":{"line":502,"column":12,"offset":11887},"end":{"line":502,"column":13,"offset":11888}}}],"position":{"start":{"line":502,"column":1,"offset":11876},"end":{"line":502,"column":13,"offset":11888}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">runServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// client for accounts service</span>\n    tlsCreds <span class=\"token operator\">:=</span> credentials<span class=\"token punctuation\">.</span><span class=\"token function\">NewTLS</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>tls<span class=\"token punctuation\">.</span>Config<span class=\"token punctuation\">{</span>InsecureSkipVerify<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    conn<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> grpc<span class=\"token punctuation\">.</span><span class=\"token function\">Dial</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"localhost:5052\"</span><span class=\"token punctuation\">,</span>\n        grpc<span class=\"token punctuation\">.</span><span class=\"token function\">WithTransportCredentials</span><span class=\"token punctuation\">(</span>tlsCreds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">WithClientInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// &lt;==</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to dial accounts server: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    accounts <span class=\"token operator\">:=</span> rpc<span class=\"token punctuation\">.</span><span class=\"token function\">NewAccountsClient</span><span class=\"token punctuation\">(</span>conn<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":504,"column":1,"offset":11890},"end":{"line":517,"column":4,"offset":12309}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Server-interceptor","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Server-interceptor","aria-label":"Server interceptor permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Server interceptor","position":{"start":{"line":523,"column":5,"offset":12319},"end":{"line":523,"column":23,"offset":12337}}}],"position":{"start":{"line":523,"column":1,"offset":12315},"end":{"line":523,"column":23,"offset":12337}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"On the server side, there’s a ","position":{"start":{"line":525,"column":1,"offset":12339},"end":{"line":525,"column":31,"offset":12369}}},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"server interceptor","position":{"start":{"line":525,"column":32,"offset":12370},"end":{"line":525,"column":50,"offset":12388}}}],"position":{"start":{"line":525,"column":31,"offset":12369},"end":{"line":525,"column":51,"offset":12389}}},{"type":"text","value":".","position":{"start":{"line":525,"column":51,"offset":12389},"end":{"line":525,"column":52,"offset":12390}}}],"position":{"start":{"line":525,"column":1,"offset":12339},"end":{"line":525,"column":52,"offset":12390}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">interceptor.go</code>","position":{"start":{"line":528,"column":1,"offset":12393},"end":{"line":528,"column":17,"offset":12409}}},{"type":"text","value":":","position":{"start":{"line":528,"column":17,"offset":12409},"end":{"line":528,"column":18,"offset":12410}}}],"position":{"start":{"line":528,"column":1,"offset":12393},"end":{"line":528,"column":18,"offset":12410}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">ServerInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> grpc<span class=\"token punctuation\">.</span>ServerOption <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> grpc<span class=\"token punctuation\">.</span><span class=\"token function\">UnaryInterceptor</span><span class=\"token punctuation\">(</span>serverInterceptor<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">func</span> <span class=\"token function\">serverInterceptor</span><span class=\"token punctuation\">(</span>\n    ctx context<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">,</span>\n    req <span class=\"token keyword\">interface</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    info <span class=\"token operator\">*</span>grpc<span class=\"token punctuation\">.</span>UnaryServerInfo<span class=\"token punctuation\">,</span>\n    handler grpc<span class=\"token punctuation\">.</span>UnaryHandler<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">interface</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    start <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    resp<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> <span class=\"token function\">handler</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> req<span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"invoke server method=%s duration=%s error=%v\"</span><span class=\"token punctuation\">,</span> info<span class=\"token punctuation\">.</span>FullMethod<span class=\"token punctuation\">,</span>\n        time<span class=\"token punctuation\">.</span><span class=\"token function\">Since</span><span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> resp<span class=\"token punctuation\">,</span> err\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":530,"column":1,"offset":12412},"end":{"line":547,"column":4,"offset":12873}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">server.go</code>","position":{"start":{"line":550,"column":1,"offset":12876},"end":{"line":550,"column":12,"offset":12887}}},{"type":"text","value":":","position":{"start":{"line":550,"column":12,"offset":12887},"end":{"line":550,"column":13,"offset":12888}}}],"position":{"start":{"line":550,"column":1,"offset":12876},"end":{"line":550,"column":13,"offset":12888}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">runServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// cache server</span>\n    tlsCreds<span class=\"token punctuation\">,</span> err <span class=\"token operator\">=</span> credentials<span class=\"token punctuation\">.</span><span class=\"token function\">NewServerTLSFromFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tls.crt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tls.key\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> err\n    <span class=\"token punctuation\">}</span>\n    srv <span class=\"token operator\">:=</span> grpc<span class=\"token punctuation\">.</span><span class=\"token function\">NewServer</span><span class=\"token punctuation\">(</span>grpc<span class=\"token punctuation\">.</span><span class=\"token function\">Creds</span><span class=\"token punctuation\">(</span>tlsCreds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">ServerInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    rpc<span class=\"token punctuation\">.</span><span class=\"token function\">RegisterCacheServer</span><span class=\"token punctuation\">(</span>srv<span class=\"token punctuation\">,</span> <span class=\"token function\">NewCacheService</span><span class=\"token punctuation\">(</span>accounts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    l<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> net<span class=\"token punctuation\">.</span><span class=\"token function\">Listen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tcp\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"localhost:5051\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> err\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> srv<span class=\"token punctuation\">.</span><span class=\"token function\">Serve</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":551,"column":1,"offset":12889},"end":{"line":567,"column":4,"offset":13314}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Adding-timeouts","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Adding-timeouts","aria-label":"Adding timeouts permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Adding timeouts","position":{"start":{"line":574,"column":5,"offset":13325},"end":{"line":574,"column":20,"offset":13340}}}],"position":{"start":{"line":574,"column":1,"offset":13321},"end":{"line":574,"column":20,"offset":13340}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Server-side timeout:","position":{"start":{"line":577,"column":1,"offset":13343},"end":{"line":577,"column":21,"offset":13363}}}],"position":{"start":{"line":577,"column":1,"offset":13343},"end":{"line":577,"column":21,"offset":13363}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">server.go</code>","position":{"start":{"line":579,"column":1,"offset":13365},"end":{"line":579,"column":12,"offset":13376}}},{"type":"text","value":":","position":{"start":{"line":579,"column":12,"offset":13376},"end":{"line":579,"column":13,"offset":13377}}}],"position":{"start":{"line":579,"column":1,"offset":13365},"end":{"line":579,"column":13,"offset":13377}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">*</span>CacheService<span class=\"token punctuation\">)</span> <span class=\"token function\">Store</span><span class=\"token punctuation\">(</span>ctx context<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">,</span> req <span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>StoreReq<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>StoreResp<span class=\"token punctuation\">,</span> <span class=\"token builtin\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    accountsCtx<span class=\"token punctuation\">,</span> <span class=\"token boolean\">_</span> <span class=\"token operator\">:=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">WithTimeout</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>time<span class=\"token punctuation\">.</span>Second<span class=\"token punctuation\">)</span>\n    resp<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> s<span class=\"token punctuation\">.</span>accounts<span class=\"token punctuation\">.</span><span class=\"token function\">GetByToken</span><span class=\"token punctuation\">(</span>accountsCtx<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>GetByTokenReq<span class=\"token punctuation\">{</span>\n        Token<span class=\"token punctuation\">:</span> req<span class=\"token punctuation\">.</span>AccountToken<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">,</span> err\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> s<span class=\"token punctuation\">.</span>keysByAccount<span class=\"token punctuation\">[</span>req<span class=\"token punctuation\">.</span>AccountToken<span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> resp<span class=\"token punctuation\">.</span>Account<span class=\"token punctuation\">.</span>MaxCacheKeys <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">,</span> status<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span>codes<span class=\"token punctuation\">.</span>FailedPrecondition<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Account %s exceeds max\nkey limit %d\"</span><span class=\"token punctuation\">,</span> req<span class=\"token punctuation\">.</span>AccountToken<span class=\"token punctuation\">,</span> resp<span class=\"token punctuation\">.</span>Account<span class=\"token punctuation\">.</span>MaxCacheKeys<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":581,"column":1,"offset":13379},"end":{"line":596,"column":4,"offset":13948}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now you look in the logs you and find you’re still failing SLA. Some round-trips take 2.2 seconds (more than 2 seconds). Why? Your timeout only covers a portion of the full request/response roundtrip.","position":{"start":{"line":602,"column":1,"offset":13954},"end":{"line":602,"column":201,"offset":14154}}}],"position":{"start":{"line":602,"column":1,"offset":13954},"end":{"line":602,"column":201,"offset":14154}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So let the client set its own timeout:","position":{"start":{"line":606,"column":1,"offset":14158},"end":{"line":606,"column":39,"offset":14196}}}],"position":{"start":{"line":606,"column":1,"offset":14158},"end":{"line":606,"column":39,"offset":14196}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">client.go</code>","position":{"start":{"line":608,"column":1,"offset":14198},"end":{"line":608,"column":12,"offset":14209}}},{"type":"text","value":":","position":{"start":{"line":608,"column":12,"offset":14209},"end":{"line":608,"column":13,"offset":14210}}}],"position":{"start":{"line":608,"column":1,"offset":14198},"end":{"line":608,"column":13,"offset":14210}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">runClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// store</span>\n    ctx<span class=\"token punctuation\">,</span> <span class=\"token boolean\">_</span> <span class=\"token operator\">:=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">WithTimeout</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span>Second<span class=\"token punctuation\">)</span>\n    <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> err <span class=\"token operator\">=</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">Store</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>StoreReq<span class=\"token punctuation\">{</span>\n        AccountToken<span class=\"token punctuation\">:</span> <span class=\"token string\">\"inconshreveable\"</span><span class=\"token punctuation\">,</span>\n    Key<span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"gopher\"</span><span class=\"token punctuation\">,</span>\n    Val<span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"con\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to store: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// get</span>\n    ctx<span class=\"token punctuation\">,</span> <span class=\"token boolean\">_</span> <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">WithTimeout</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token operator\">*</span>time<span class=\"token punctuation\">.</span>Millisecond<span class=\"token punctuation\">)</span>\n    resp<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>GetReq<span class=\"token punctuation\">{</span>Key<span class=\"token punctuation\">:</span> <span class=\"token string\">\"gopher\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to get: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Got cached value %s\\n\"</span><span class=\"token punctuation\">,</span> resp<span class=\"token punctuation\">.</span>Val<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":609,"column":1,"offset":14211},"end":{"line":634,"column":4,"offset":14853}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"How does that interact with the timeout you set previously on the server? Simple: “the context propagates through.”","position":{"start":{"line":638,"column":1,"offset":14857},"end":{"line":638,"column":116,"offset":14972}}}],"position":{"start":{"line":638,"column":1,"offset":14857},"end":{"line":638,"column":116,"offset":14972}}},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"//images.contentful.com/le3mxztn6yoo/46Fbuugk4o4oGasG0SW4My/3a033c1566a68bdd38f9b4cdf5045691/Selection_081.png","alt":"Selection 081"},"children":[],"position":{"start":{"line":640,"column":1,"offset":14974},"end":{"line":640,"column":129,"offset":15102}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Dry-run","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Dry-run","aria-label":"Dry run permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Dry run","position":{"start":{"line":644,"column":5,"offset":15110},"end":{"line":644,"column":12,"offset":15117}}}],"position":{"start":{"line":644,"column":1,"offset":15106},"end":{"line":644,"column":12,"offset":15117}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now let’s say you want to call your service with a dry run flag. I want to run it without side effects. I want it to work on all mutable API.","position":{"start":{"line":646,"column":1,"offset":15119},"end":{"line":646,"column":142,"offset":15260}}}],"position":{"start":{"line":646,"column":1,"offset":15119},"end":{"line":646,"column":142,"offset":15260}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This is simple with passing the right gRPC metadata (analogous to HTTP headers).","position":{"start":{"line":648,"column":1,"offset":15262},"end":{"line":648,"column":81,"offset":15342}}}],"position":{"start":{"line":648,"column":1,"offset":15262},"end":{"line":648,"column":81,"offset":15342}}},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"//images.contentful.com/le3mxztn6yoo/1cu5lDbGRqwQgEeG4ME2SU/a35157ce995e8ce60f05d163a7f2b6c0/Selection_082.png","alt":"Selection 082"},"children":[],"position":{"start":{"line":650,"column":1,"offset":15344},"end":{"line":650,"column":129,"offset":15472}}},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"//images.contentful.com/le3mxztn6yoo/42rgrFoTK8KuSi4Uyeoks8/df479b68fed9b8eef3f082692ef78047/Selection_083.png","alt":"Selection 083"},"children":[],"position":{"start":{"line":651,"column":1,"offset":15473},"end":{"line":651,"column":129,"offset":15601}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Networks-fail","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Networks-fail","aria-label":"Networks fail permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Networks fail","position":{"start":{"line":654,"column":5,"offset":15608},"end":{"line":654,"column":18,"offset":15621}}}],"position":{"start":{"line":654,"column":1,"offset":15604},"end":{"line":654,"column":18,"offset":15621}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let’s add retry logic.","position":{"start":{"line":656,"column":1,"offset":15623},"end":{"line":656,"column":23,"offset":15645}}}],"position":{"start":{"line":656,"column":1,"offset":15623},"end":{"line":656,"column":23,"offset":15645}}},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"//images.contentful.com/le3mxztn6yoo/l7PpLqfUxqK0SEAooMAMY/88cd119ef76c35c7b29a76f76e63ef2b/Selection_084.png","alt":"Selection 084"},"children":[],"position":{"start":{"line":658,"column":1,"offset":15647},"end":{"line":658,"column":128,"offset":15774}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Idempotent logic? We can have safe retries:","position":{"start":{"line":660,"column":1,"offset":15776},"end":{"line":660,"column":44,"offset":15819}}}],"position":{"start":{"line":660,"column":1,"offset":15776},"end":{"line":660,"column":44,"offset":15819}}},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"//images.contentful.com/le3mxztn6yoo/40Rpe4eCtyocQwcu8OIm0Y/f624ef7253acf6785ac03bfe3746665d/Selection_085.png","alt":"Selection 085"},"children":[],"position":{"start":{"line":662,"column":1,"offset":15821},"end":{"line":662,"column":129,"offset":15949}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"But now failed operations are slow. What’s going on?","position":{"start":{"line":666,"column":1,"offset":15953},"end":{"line":666,"column":53,"offset":16005}}}],"position":{"start":{"line":666,"column":1,"offset":15953},"end":{"line":666,"column":53,"offset":16005}}},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"//images.contentful.com/le3mxztn6yoo/4DAjgPxqooOeU4C8CwcqUW/3ecb0bb288bb189deaaf2e4c2954d203/Selection_086.png","alt":"Selection 086"},"children":[],"position":{"start":{"line":668,"column":1,"offset":16007},"end":{"line":668,"column":129,"offset":16135}}},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"//images.contentful.com/le3mxztn6yoo/4CSpptKb4QI8MI86KySMo0/470041f59ad0ce66c3e3c28f53ddb07e/Selection_087.png","alt":"Selection 087"},"children":[],"position":{"start":{"line":670,"column":1,"offset":16137},"end":{"line":670,"column":129,"offset":16265}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Structured-errors","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Structured-errors","aria-label":"Structured errors permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Structured errors","position":{"start":{"line":675,"column":5,"offset":16274},"end":{"line":675,"column":22,"offset":16291}}}],"position":{"start":{"line":675,"column":1,"offset":16270},"end":{"line":675,"column":22,"offset":16291}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In your response message, you add a new field that indicates whether it is possible to retry in the case of an error.","position":{"start":{"line":677,"column":1,"offset":16293},"end":{"line":677,"column":118,"offset":16410}}}],"position":{"start":{"line":677,"column":1,"offset":16293},"end":{"line":677,"column":118,"offset":16410}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You really want a structured error, not just a code and string. You want a full object’s worth of parameters.","position":{"start":{"line":679,"column":1,"offset":16412},"end":{"line":679,"column":110,"offset":16521}}}],"position":{"start":{"line":679,"column":1,"offset":16412},"end":{"line":679,"column":110,"offset":16521}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Something like this:","position":{"start":{"line":681,"column":1,"offset":16523},"end":{"line":681,"column":21,"offset":16543}}}],"position":{"start":{"line":681,"column":1,"offset":16523},"end":{"line":681,"column":21,"offset":16543}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\">message Error <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">int64</span> code <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token builtin\">string</span> message <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n  <span class=\"token builtin\">bool</span> temporary <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n  <span class=\"token builtin\">int64</span> userErrorCode <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":683,"column":1,"offset":16545},"end":{"line":690,"column":4,"offset":16661}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Unfortunately, this gets a little messy… A lot of serialization and deserialization is required, since gRPC doesn’t have response bodies.","position":{"start":{"line":693,"column":1,"offset":16664},"end":{"line":693,"column":140,"offset":16803}}}],"position":{"start":{"line":693,"column":1,"offset":16664},"end":{"line":693,"column":140,"offset":16803}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This is one of the larger frustrations working with gRPC compared to HTTP.","position":{"start":{"line":697,"column":1,"offset":16807},"end":{"line":697,"column":75,"offset":16881}}}],"position":{"start":{"line":697,"column":1,"offset":16807},"end":{"line":697,"column":75,"offset":16881}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Another-feature-request-Cache-dump","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Another-feature-request-Cache-dump","aria-label":"Another feature request Cache dump permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Another feature request: Cache dump","position":{"start":{"line":699,"column":5,"offset":16887},"end":{"line":699,"column":40,"offset":16922}}}],"position":{"start":{"line":699,"column":1,"offset":16883},"end":{"line":699,"column":40,"offset":16922}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let’s say you now want to add the ability to dump the contents of your cache service.","position":{"start":{"line":701,"column":1,"offset":16924},"end":{"line":701,"column":86,"offset":17009}}}],"position":{"start":{"line":701,"column":1,"offset":16924},"end":{"line":701,"column":86,"offset":17009}}},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"//images.contentful.com/le3mxztn6yoo/77KvmSQJ1ecosQC8uA6806/6eb5773b2e12faf421cf1f20c624a6ab/Selection_088.png","alt":"Selection 088"},"children":[],"position":{"start":{"line":703,"column":1,"offset":17011},"end":{"line":703,"column":129,"offset":17139}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now you run into non-enough memory errors. What defensive measures can you add?","position":{"start":{"line":706,"column":1,"offset":17142},"end":{"line":706,"column":80,"offset":17221}}}],"position":{"start":{"line":706,"column":1,"offset":17142},"end":{"line":706,"column":80,"offset":17221}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Set max number of concurrent streams (simultaneous HTTP/2 streams per client):","position":{"start":{"line":709,"column":1,"offset":17224},"end":{"line":709,"column":79,"offset":17302}}}],"position":{"start":{"line":709,"column":1,"offset":17224},"end":{"line":709,"column":79,"offset":17302}}},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"//images.contentful.com/le3mxztn6yoo/5YljZmdcicicEcouGkOmiI/919124f6ceb6a8ccf04294f6436f3a20/Selection_089.png","alt":"Selection 089"},"children":[],"position":{"start":{"line":712,"column":1,"offset":17305},"end":{"line":712,"column":129,"offset":17433}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"gRPC also lets you use an InTap handler, a piece of code just like the server interceptor, but happens a little bit earlier in request lifecycle.","position":{"start":{"line":716,"column":1,"offset":17437},"end":{"line":716,"column":146,"offset":17582}}}],"position":{"start":{"line":716,"column":1,"offset":17437},"end":{"line":716,"column":146,"offset":17582}}},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"//images.contentful.com/le3mxztn6yoo/5T1mTVzab6maE4WIu02qOe/79018ce2d56ff7a4f3a6db4f552507b2/Selection_090.png","alt":"Selection 090"},"children":[],"position":{"start":{"line":718,"column":1,"offset":17584},"end":{"line":718,"column":129,"offset":17712}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"But what if that doesn’t solve all your memory issues?","position":{"start":{"line":720,"column":1,"offset":17714},"end":{"line":720,"column":55,"offset":17768}}}],"position":{"start":{"line":720,"column":1,"offset":17714},"end":{"line":720,"column":55,"offset":17768}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Streaming","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Streaming","aria-label":"Streaming permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Streaming","position":{"start":{"line":722,"column":5,"offset":17774},"end":{"line":722,"column":14,"offset":17783}}}],"position":{"start":{"line":722,"column":1,"offset":17770},"end":{"line":722,"column":14,"offset":17783}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">app.proto</code>","position":{"start":{"line":725,"column":1,"offset":17786},"end":{"line":725,"column":12,"offset":17797}}},{"type":"text","value":":","position":{"start":{"line":725,"column":12,"offset":17797},"end":{"line":725,"column":13,"offset":17798}}}],"position":{"start":{"line":725,"column":1,"offset":17786},"end":{"line":725,"column":13,"offset":17798}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\">syntax <span class=\"token operator\">=</span> <span class=\"token string\">\"proto3\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">package</span> rpc<span class=\"token punctuation\">;</span>\nservice Cache <span class=\"token punctuation\">{</span>\n  rpc <span class=\"token function\">Store</span><span class=\"token punctuation\">(</span>StoreReq<span class=\"token punctuation\">)</span> returns <span class=\"token punctuation\">(</span>StoreResp<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  rpc <span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>GetReq<span class=\"token punctuation\">)</span> returns <span class=\"token punctuation\">(</span>GetResp<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  rpc <span class=\"token function\">Dump</span><span class=\"token punctuation\">(</span>DumpReq<span class=\"token punctuation\">)</span> returns <span class=\"token punctuation\">(</span>stream DumpItem<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\nmessage DumpReq <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span>\nmessage DumpItem <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">string</span> key <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  bytes val <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":727,"column":1,"offset":17800},"end":{"line":742,"column":4,"offset":18069}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">server.go</code>","position":{"start":{"line":744,"column":1,"offset":18071},"end":{"line":744,"column":12,"offset":18082}}},{"type":"text","value":":","position":{"start":{"line":744,"column":12,"offset":18082},"end":{"line":744,"column":13,"offset":18083}}}],"position":{"start":{"line":744,"column":1,"offset":18071},"end":{"line":744,"column":13,"offset":18083}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">*</span>CacheService<span class=\"token punctuation\">)</span> <span class=\"token function\">Dump</span><span class=\"token punctuation\">(</span>req <span class=\"token operator\">*</span>rpc<span class=\"token punctuation\">.</span>DumpReq<span class=\"token punctuation\">,</span> stream rpc<span class=\"token punctuation\">.</span>Cache_DumpServer<span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> k<span class=\"token punctuation\">,</span> v <span class=\"token operator\">:=</span> <span class=\"token keyword\">range</span> s<span class=\"token punctuation\">.</span>store <span class=\"token punctuation\">{</span>\n        stream<span class=\"token punctuation\">.</span><span class=\"token function\">Send</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>DumpItem<span class=\"token punctuation\">{</span>\n            Key<span class=\"token punctuation\">:</span> k<span class=\"token punctuation\">,</span>\n            Val<span class=\"token punctuation\">:</span> v<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":746,"column":1,"offset":18085},"end":{"line":757,"column":4,"offset":18319}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">client.go</code>","position":{"start":{"line":759,"column":1,"offset":18321},"end":{"line":759,"column":12,"offset":18332}}},{"type":"text","value":":","position":{"start":{"line":759,"column":12,"offset":18332},"end":{"line":759,"column":13,"offset":18333}}}],"position":{"start":{"line":759,"column":1,"offset":18321},"end":{"line":759,"column":13,"offset":18333}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">runClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">error</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// stream</span>\n    stream<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">Dump</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>rpc<span class=\"token punctuation\">.</span>DumpReq<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to dump: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">{</span>\n        item<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> stream<span class=\"token punctuation\">.</span><span class=\"token function\">Recv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> err <span class=\"token operator\">==</span> io<span class=\"token punctuation\">.</span>EOF <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">break</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to stream item: %v\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Cache Entry: %s => %s\\n\"</span><span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">.</span>Key<span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">.</span>Val<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":761,"column":1,"offset":18335},"end":{"line":781,"column":4,"offset":18818}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Load-balancing","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Load-balancing","aria-label":"Load balancing permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Load balancing","position":{"start":{"line":787,"column":5,"offset":18828},"end":{"line":787,"column":19,"offset":18842}}}],"position":{"start":{"line":787,"column":1,"offset":18824},"end":{"line":787,"column":19,"offset":18842}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"There’s not enough time to go into detail, but one thing to note: The fact that you’re establishing a single persistent connection means that every request you make goes to the same server.","position":{"start":{"line":789,"column":1,"offset":18844},"end":{"line":789,"column":190,"offset":19033}}}],"position":{"start":{"line":789,"column":1,"offset":18844},"end":{"line":789,"column":190,"offset":19033}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So, you have to put the load-balancing logic in the client.","position":{"start":{"line":791,"column":1,"offset":19035},"end":{"line":791,"column":60,"offset":19094}}}],"position":{"start":{"line":791,"column":1,"offset":19035},"end":{"line":791,"column":60,"offset":19094}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You can of course put this logic into a middleware server that does this for you, so the actual client doesn’t have to worry about this. This is still pretty new, the spec is experimental.","position":{"start":{"line":793,"column":1,"offset":19096},"end":{"line":793,"column":189,"offset":19284}}}],"position":{"start":{"line":793,"column":1,"offset":19096},"end":{"line":793,"column":189,"offset":19284}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"gRPC-clients-in-other-languages","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#gRPC-clients-in-other-languages","aria-label":"gRPC clients in other languages permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"gRPC clients in other languages","position":{"start":{"line":797,"column":5,"offset":19292},"end":{"line":797,"column":36,"offset":19323}}}],"position":{"start":{"line":797,"column":1,"offset":19288},"end":{"line":797,"column":36,"offset":19323}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Using your service from Python:","position":{"start":{"line":799,"column":1,"offset":19325},"end":{"line":799,"column":32,"offset":19356}}}],"position":{"start":{"line":799,"column":1,"offset":19325},"end":{"line":799,"column":32,"offset":19356}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">import</span> grpc\n<span class=\"token keyword\">import</span> rpc_pb2 <span class=\"token keyword\">as</span> rpc\n\nchannel <span class=\"token operator\">=</span> grpc<span class=\"token punctuation\">.</span>insecure_channel<span class=\"token punctuation\">(</span><span class=\"token string\">'localhost:5051'</span><span class=\"token punctuation\">)</span>\ncache_svc <span class=\"token operator\">=</span> rpc<span class=\"token punctuation\">.</span>CacheStub<span class=\"token punctuation\">(</span>channel<span class=\"token punctuation\">)</span>\nresp <span class=\"token operator\">=</span> cache_svc<span class=\"token punctuation\">.</span>Get<span class=\"token punctuation\">(</span>rpc<span class=\"token punctuation\">.</span>GetReq<span class=\"token punctuation\">(</span></code></pre></div>","position":{"start":{"line":801,"column":1,"offset":19358},"end":{"line":808,"column":4,"offset":19520}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"gRPC-downsides","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#gRPC-downsides","aria-label":"gRPC downsides permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"gRPC downsides","position":{"start":{"line":815,"column":5,"offset":19531},"end":{"line":815,"column":19,"offset":19545}}}],"position":{"start":{"line":815,"column":1,"offset":19527},"end":{"line":815,"column":19,"offset":19545}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Load Balancing","position":{"start":{"line":818,"column":3,"offset":19550},"end":{"line":818,"column":17,"offset":19564}}}],"position":{"start":{"line":818,"column":1,"offset":19548},"end":{"line":818,"column":17,"offset":19564}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Structured error handling is unfortunate","position":{"start":{"line":819,"column":3,"offset":19567},"end":{"line":819,"column":43,"offset":19607}}}],"position":{"start":{"line":819,"column":1,"offset":19565},"end":{"line":819,"column":43,"offset":19607}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"No support for browser JS","position":{"start":{"line":820,"column":3,"offset":19610},"end":{"line":820,"column":28,"offset":19635}}}],"position":{"start":{"line":820,"column":1,"offset":19608},"end":{"line":820,"column":28,"offset":19635}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Breaking API changes","position":{"start":{"line":821,"column":3,"offset":19638},"end":{"line":821,"column":23,"offset":19658}}}],"position":{"start":{"line":821,"column":1,"offset":19636},"end":{"line":821,"column":23,"offset":19658}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Poor documentation for some languages","position":{"start":{"line":822,"column":3,"offset":19661},"end":{"line":822,"column":40,"offset":19698}}}],"position":{"start":{"line":822,"column":1,"offset":19659},"end":{"line":822,"column":40,"offset":19698}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"No standardization across languages","position":{"start":{"line":823,"column":3,"offset":19701},"end":{"line":823,"column":38,"offset":19736}}}],"position":{"start":{"line":823,"column":1,"offset":19699},"end":{"line":823,"column":38,"offset":19736}}},{"type":"text","value":"\n"}],"position":{"start":{"line":818,"column":1,"offset":19548},"end":{"line":823,"column":38,"offset":19736}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Where-is-gRPC-used-in-production","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#Where-is-gRPC-used-in-production","aria-label":"Where is gRPC used in production permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"Where is gRPC used in production?","position":{"start":{"line":827,"column":5,"offset":19744},"end":{"line":827,"column":38,"offset":19777}}}],"position":{"start":{"line":827,"column":1,"offset":19740},"end":{"line":827,"column":38,"offset":19777}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"ngrok — all 20+ internal services communicate via gRPC","position":{"start":{"line":829,"column":3,"offset":19781},"end":{"line":829,"column":57,"offset":19835}}}],"position":{"start":{"line":829,"column":1,"offset":19779},"end":{"line":829,"column":57,"offset":19835}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Square — replacement for all of their internal RPC. one of\nthe very first adopters and contributors to gRPC.","position":{"start":{"line":830,"column":3,"offset":19838},"end":{"line":831,"column":50,"offset":19946}}}],"position":{"start":{"line":830,"column":1,"offset":19836},"end":{"line":831,"column":50,"offset":19946}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"CoreOS — Production API for etcd v3 is entirely gRPC.","position":{"start":{"line":832,"column":3,"offset":19949},"end":{"line":832,"column":56,"offset":20002}}}],"position":{"start":{"line":832,"column":1,"offset":19947},"end":{"line":832,"column":56,"offset":20002}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Google — Production APIs for Google Cloud Services (e.g.\nPubSub, Speech Rec)","position":{"start":{"line":833,"column":3,"offset":20005},"end":{"line":834,"column":20,"offset":20081}}}],"position":{"start":{"line":833,"column":1,"offset":20003},"end":{"line":834,"column":20,"offset":20081}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Netflix, Yik Yak, VSCO, Cockroach, + many more","position":{"start":{"line":835,"column":3,"offset":20084},"end":{"line":835,"column":49,"offset":20130}}}],"position":{"start":{"line":835,"column":1,"offset":20082},"end":{"line":835,"column":49,"offset":20130}}},{"type":"text","value":"\n"}],"position":{"start":{"line":829,"column":1,"offset":19779},"end":{"line":835,"column":49,"offset":20130}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"The-future-of-gRPC","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#The-future-of-gRPC","aria-label":"The future of gRPC permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]},{"type":"text","value":"The future of gRPC","position":{"start":{"line":841,"column":5,"offset":20140},"end":{"line":841,"column":23,"offset":20158}}}],"position":{"start":{"line":841,"column":1,"offset":20136},"end":{"line":841,"column":23,"offset":20158}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The future of gRPC is easy to track: look at the grpc/grpc-proposals repository and grpc-io mailing list.","position":{"start":{"line":843,"column":1,"offset":20160},"end":{"line":843,"column":106,"offset":20265}}}],"position":{"start":{"line":843,"column":1,"offset":20160},"end":{"line":843,"column":106,"offset":20265}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"New languages (swift + haskell are currently experimental)","position":{"start":{"line":846,"column":3,"offset":20270},"end":{"line":846,"column":61,"offset":20328}}}],"position":{"start":{"line":846,"column":1,"offset":20268},"end":{"line":846,"column":61,"offset":20328}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Further stability, reliability, performance improvements","position":{"start":{"line":847,"column":3,"offset":20331},"end":{"line":847,"column":59,"offset":20387}}}],"position":{"start":{"line":847,"column":1,"offset":20329},"end":{"line":847,"column":59,"offset":20387}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Increasingly fine-grained APIs for customizing behavior (connection\nmanagement, channel tracing)","position":{"start":{"line":848,"column":3,"offset":20390},"end":{"line":849,"column":29,"offset":20486}}}],"position":{"start":{"line":848,"column":1,"offset":20388},"end":{"line":849,"column":29,"offset":20486}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Browser JS!","position":{"start":{"line":850,"column":3,"offset":20489},"end":{"line":850,"column":14,"offset":20500}}}],"position":{"start":{"line":850,"column":1,"offset":20487},"end":{"line":850,"column":14,"offset":20500}}},{"type":"text","value":"\n"}],"position":{"start":{"line":846,"column":1,"offset":20268},"end":{"line":850,"column":14,"offset":20500}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":851,"column":1,"offset":20501}}}}