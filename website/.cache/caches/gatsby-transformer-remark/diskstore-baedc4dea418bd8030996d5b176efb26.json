{"expireTime":9007200905229169000,"key":"transformer-remark-markdown-ast-732c6983f179b8495a408bb7a7769d24-gatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-unwrap-imagesgatsby-remark-imagesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"Developers on some teams frequently search multiple revisions, such as long-lived release branches or important tags. We added ","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":128,"offset":128},"indent":[]}},{"type":"link","title":null,"url":"/blog/sourcegraph-3.16#introducing-version-contexts-to-search-past-releases","children":[{"type":"text","value":"version contexts","position":{"start":{"line":2,"column":129,"offset":129},"end":{"line":2,"column":145,"offset":145},"indent":[]}}],"position":{"start":{"line":2,"column":128,"offset":128},"end":{"line":2,"column":223,"offset":223},"indent":[]}},{"type":"text","value":" in Sourcegraph 3.16 to make it easier for developers to search a collection of repositories at specified revisions. However, Sourcegraph still only ","position":{"start":{"line":2,"column":223,"offset":223},"end":{"line":2,"column":372,"offset":372},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"indexed","position":{"start":{"line":2,"column":373,"offset":373},"end":{"line":2,"column":380,"offset":380},"indent":[]}}],"position":{"start":{"line":2,"column":372,"offset":372},"end":{"line":2,"column":381,"offset":381},"indent":[]}},{"type":"text","value":" your default branch (whichever branch ","position":{"start":{"line":2,"column":381,"offset":381},"end":{"line":2,"column":420,"offset":420},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">HEAD</code>","position":{"start":{"line":2,"column":420,"offset":420},"end":{"line":2,"column":426,"offset":426},"indent":[]}},{"type":"text","value":" points to in Git, conventionally the branch called ","position":{"start":{"line":2,"column":426,"offset":426},"end":{"line":2,"column":478,"offset":478},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">master</code>","position":{"start":{"line":2,"column":478,"offset":478},"end":{"line":2,"column":486,"offset":486},"indent":[]}},{"type":"text","value":"). This meant that when searching a non-default branch for the first time, Sourcegraph would not consult an index, leading to long, multi-second waits for search results or in some cases, timeouts.","position":{"start":{"line":2,"column":486,"offset":486},"end":{"line":2,"column":683,"offset":683},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":683,"offset":683},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In Sourcegraph 3.18, we have added the ability to index branches other than the default branch, which should keep most searches under one second.","position":{"start":{"line":4,"column":1,"offset":685},"end":{"line":4,"column":146,"offset":830},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":685},"end":{"line":4,"column":146,"offset":830},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#Example-configuration","title":null,"children":[],"data":{"hProperties":{"aria-label":"Example configuration permalink","class":"anchor before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg>"}]}},{"type":"text","value":"Example configuration","position":{"start":{"line":6,"column":4,"offset":835},"end":{"line":6,"column":25,"offset":856},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":832},"end":{"line":6,"column":25,"offset":856},"indent":[]},"data":{"id":"Example-configuration","htmlAttributes":{"id":"Example-configuration"},"hProperties":{"id":"Example-configuration","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"Here’s how you would configure Sourcegraph to index multiple branches:","position":{"start":{"line":8,"column":1,"offset":858},"end":{"line":8,"column":71,"offset":928},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":858},"end":{"line":8,"column":71,"offset":928},"indent":[]}},{"type":"html","lang":"json","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"experimentalFeatures\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"search.index.branches\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"github.com/sourcegraph/sourcegraph\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"3.17\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"v3.0.0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"github.com/kubernetes/kubernetes\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"release-1.17\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"github.com/go-yaml/yaml\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"v2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"v3\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":10,"column":1,"offset":930},"end":{"line":18,"column":4,"offset":1166},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"And here’s how you can enable version contexts to search multiple repositories at a coherent set of (non-default) revisions:","position":{"start":{"line":20,"column":1,"offset":1168},"end":{"line":20,"column":125,"offset":1292},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1168},"end":{"line":20,"column":125,"offset":1292},"indent":[]}},{"type":"html","lang":"json","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"experimentalFeatures\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"versionContexts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Current\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"revisions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token property\">\"rev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"HEAD\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"repo\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"github.com/sourcegraph/sourcegraph\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token property\">\"rev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"HEAD\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"repo\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"github.com/sourcegraph/deploy-sourcegraph\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token property\">\"rev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"HEAD\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"repo\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"github.com/sourcegraph/zoekt\"</span> <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"3.17\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"revisions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token property\">\"rev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"v3.17.3\"</span><span class=\"token punctuation\">,</span>  <span class=\"token property\">\"repo\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"github.com/sourcegraph/sourcegraph\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token property\">\"rev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"3.17\"</span><span class=\"token punctuation\">,</span>     <span class=\"token property\">\"repo\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"github.com/sourcegraph/sourcegraph\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token property\">\"rev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"3.17\"</span><span class=\"token punctuation\">,</span>     <span class=\"token property\">\"repo\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"github.com/sourcegraph/deploy-sourcegraph\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token property\">\"rev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"8aa57bd3\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"repo\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"github.com/sourcegraph/zoekt\"</span> <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":22,"column":1,"offset":1294},"end":{"line":44,"column":4,"offset":2017},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Any ","position":{"start":{"line":46,"column":1,"offset":2019},"end":{"line":46,"column":5,"offset":2023},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">repo@revision</code>","position":{"start":{"line":46,"column":5,"offset":2023},"end":{"line":46,"column":20,"offset":2038},"indent":[]}},{"type":"text","value":" mentioned in a version context or in ","position":{"start":{"line":46,"column":20,"offset":2038},"end":{"line":46,"column":58,"offset":2076},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">search.index.branches</code>","position":{"start":{"line":46,"column":58,"offset":2076},"end":{"line":46,"column":81,"offset":2099},"indent":[]}},{"type":"text","value":" will be indexed by the periodic indexing process (you may need to wait a few minutes for indexing to occur). As an admin you can view what is indexed for a repository through the repository setting page (“Indexing” section).","position":{"start":{"line":46,"column":81,"offset":2099},"end":{"line":46,"column":306,"offset":2324},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":2019},"end":{"line":46,"column":306,"offset":2324},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The same periodic process that cleans up old indexes and deleted repositories will also clean up deleted branches, so this gets cleaned up automatically.","position":{"start":{"line":48,"column":1,"offset":2326},"end":{"line":48,"column":154,"offset":2479},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":2326},"end":{"line":48,"column":154,"offset":2479},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This scales with the number of ","position":{"start":{"line":50,"column":1,"offset":2481},"end":{"line":50,"column":32,"offset":2512},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"unique","position":{"start":{"line":50,"column":33,"offset":2513},"end":{"line":50,"column":39,"offset":2519},"indent":[]}}],"position":{"start":{"line":50,"column":32,"offset":2512},"end":{"line":50,"column":40,"offset":2520},"indent":[]}},{"type":"text","value":" documents at a path. For example, if you index a branch A which only has one file different from your default branch, the index will only grow in size by one document. So in practice, most indexes won’t grow much by adding a branch. There is a limit of 64 indexed branches per repository.","position":{"start":{"line":50,"column":40,"offset":2520},"end":{"line":50,"column":329,"offset":2809},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":2481},"end":{"line":50,"column":329,"offset":2809},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"GitHub issue: ","position":{"start":{"line":52,"column":1,"offset":2811},"end":{"line":52,"column":15,"offset":2825},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/sourcegraph/sourcegraph/issues/6728","children":[{"type":"text","value":"#6728","position":{"start":{"line":52,"column":16,"offset":2826},"end":{"line":52,"column":21,"offset":2831},"indent":[]}}],"position":{"start":{"line":52,"column":15,"offset":2825},"end":{"line":52,"column":78,"offset":2888},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":2811},"end":{"line":52,"column":78,"offset":2888},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":53,"column":1,"offset":2889}}}}