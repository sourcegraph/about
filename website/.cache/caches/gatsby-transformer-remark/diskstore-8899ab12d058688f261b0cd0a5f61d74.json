{"expireTime":9007200905229171000,"key":"transformer-remark-markdown-html-9a5278d7685e01b5b08b59ad4d6b230b-gatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-unwrap-imagesgatsby-remark-imagesgatsby-remark-smartypants-","val":"<p>About a month ago, <a href=\"https://sourcegraph.com/\">Sourcegraph</a> released <a href=\"https://sourcegraph.github.io/checkup/\">Checkup</a>, an <a href=\"https://sourcegraph.com/github.com/sourcegraph/checkup/-/blob/checkup.go\">open source</a>, self-hosted uptime monitoring system written by <a href=\"https://github.com/mholt\">Matt Holt</a>.</p>\n<p>Following its release, a lot of people asked us how we were using Checkup at Sourcegraph. Today, we’re sharing our public <a href=\"http://checkup.sourcegraph.com/\">status page</a>, powered by Checkup, and laying out some of the big advantages we’ve found using an open source health check tool.</p>\n<p><a href=\"http://checkup.sourcegraph.com/\"><img src=\"https://cdn-images-1.medium.com/max/1000/1*9ytaM5nY14EhaIOQlDWp9g.png\"></a></p>\n<h3 id=\"Why-yet-another-uptime-tool\" style=\"position:relative;\"><a href=\"#Why-yet-another-uptime-tool\" aria-label=\"Why yet another uptime tool permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg></a>Why yet another uptime tool?</h3>\n<p>We sponsored the creation of Checkup, because we found none of the existing paid or free uptime monitors met our needs. You can read the Checkup <a href=\"https://text.sourcegraph.com/announcing-checkup-simple-self-hosted-health-checks-c5707cf729ab\">launch post</a> for details, but here’s a quick overview of some of the things it enables:</p>\n<ul>\n<li><strong>Define checks in code instead of via GUI</strong>: A lot of other uptime services require you to define your health checks manually using slow, clunky interfaces.</li>\n<li><strong>Keep health checks up-to-date</strong>: Before Checkup, we found that it was easy for our health checks to fall out of date, because they were stored outside our codebase.</li>\n<li><strong>Useful for both public and private services</strong>: You can’t use SaaS uptime monitors for services that aren’t publicly accessible on the Internet.</li>\n<li><strong>No black-box downtime</strong>: Uptime services themselves can sometimes go down and when the source and production environment are not available, it can be hard to understand why.</li>\n</ul>\n<h3 id=\"How-Sourcegraph-uses-Checkup\" style=\"position:relative;\"><a href=\"#How-Sourcegraph-uses-Checkup\" aria-label=\"How Sourcegraph uses Checkup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg></a>How Sourcegraph uses Checkup</h3>\n<p>Using an open source health check system makes it possible to incorporate health checks into a few different stages in the software development cycle.</p>\n<h4 id=\"1-Uptime-monitoring\" style=\"position:relative;\"><a href=\"#1-Uptime-monitoring\" aria-label=\"1 Uptime monitoring permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg></a>1. Uptime monitoring</h4>\n<p>The first and obvious use case is production health checking. This is what you see on <a href=\"http://checkup.sourcegraph.com\">checkup.sourcegraph.com</a>. Checkup is <a href=\"https://github.com/sourcegraph/checkup#quick-start\">easy to deploy</a> and all the monitoring data is stored in S3, so it’s easy to audit. And you can geographically distribute checks by deploying to servers in different parts of the world — anywhere where you can spin up a VPS.</p>\n<h4 id=\"2-Continuous-integration\" style=\"position:relative;\"><a href=\"#2-Continuous-integration\" aria-label=\"2 Continuous integration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg></a>2. Continuous integration</h4>\n<p>Though typically viewed as a last line of defense in production, health checks are really no different from any other test you’d like to run against your app. And as experienced software engineers know, it’s far better to catch a bug in test than in prod.</p>\n<p>Because Checkup can be used as a simple CLI, you can roll it into your continuous integration scripts. Below is a snippet taken from Sourcegraph’s CI build that demonstrates this ability. We version a <a href=\"https://github.com/sourcegraph/checkup#create-your-checkup-config\">checkup.json</a> file directly in our codebase that describes critical URLs that we must not break.</p>\n<pre name=\"00ac\" id=\"00ac\" class=\"graf graf--pre graf-after--p\">#!/bin/bash</pre>\n<pre name=\"eb8d\" id=\"eb8d\" class=\"graf graf--pre graf-after--pre\"># Quick end-to-end uptime tests\ncheckup_success=false\nsrc serve &                    # run an instance of our server\nfor i in {1..5}; do\n    sleep 2s;\n    echo \"Checkup health checks (attempt $i / 5)\";\n    if (checkup -c  ./dev/ci/checkup.json); then\n        checkup_success=true;\n        break;\n    fi;\ndone;\nkill %1                        # kill the instance of our server\nif ! \"$checkup_success\"; then\n    echo \"Checkup health checks failed after 5 attempts\" && false;\nfi</pre>\n<h4 id=\"3-In-development\" style=\"position:relative;\"><a href=\"#3-In-development\" aria-label=\"3 In development permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg></a>3. In development</h4>\n<p>What’s better than a test you can run in CI? Why, a test you can run in your dev environment, of course. Before we push a new version of Sourcegraph and kick off a CI build, we can run Checkup against a dev server to verify that all critical endpoints are live. All you need to do is run “checkup” in the terminal (it picks up the endpoints from the configuration file versioned with the code).</p>\n<img src=\"//images.contentful.com/le3mxztn6yoo/4ELiiWb7hmQCU4EUMikUwq/b4781a836fd6da394df82a39d4d4d7e9/1_DA7wnKBXsO6DqA9-i5fM7g.png\" alt=\"1*DA7wnKBXsO6DqA9-i5fM7g\">\n<h3 id=\"Why-source-accessibility-is-important\" style=\"position:relative;\"><a href=\"#Why-source-accessibility-is-important\" aria-label=\"Why source accessibility is important permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 18 95 120\" height=\"18\" width=\"18\"><path d=\"M53.69,78.7H37.94l-5.85,25H21.74l5.85-25H15.89L18,69.1H29.84l4.65-19.65H23.39l2.1-9.6H36.74l5.7-23.7H52.79l-5.7,23.7H62.84l5.7-23.7H78.89l-5.7,23.7H84.74l-2.4,9.6H70.94L66.29,69.1H77.24l-2.4,9.6H64l-5.85,25H47.84Zm-13.5-9.6H55.94l4.65-19.65H44.84Z\"/></svg></a>Why source accessibility is important</h3>\n<p>We think Checkup has a lot going for it as a health check tool. It’s not for everyone, but its simplicity and developer-driven design suit our purposes well. Besides the feature set and simple interface, we think Checkup has another strong advantage: its source code is <a href=\"https://sourcegraph.com/github.com/sourcegraph/checkup/-/blob/checkup.go\">publicly available</a>.</p>\n<p>Having the source available means you can dive into the inner workings of Checkup if unexpected behavior crops up. And you can extend the tool to fit your needs (and push those changes upstream to share those capabilities with other Checkup users). Already, community contributors have added support for new underlying data stores and new types of checks (TCP and DNS).</p>\n<p>But availability alone is not enough. There are plenty of open source projects where the code is available but inscrutable. Documentation and API design are key, but so is making the code itself as easy to navigate as possible. And in that spirit, here are 5 different places where you can dive into the Checkup source and understand how it all works:</p>\n<ul>\n<li><a href=\"https://sourcegraph.com/github.com/sourcegraph/checkup@d7cd4db3ced36aea99e56f3ed13d877688bff20c/-/def/GoPackage/github.com/sourcegraph/checkup/cmd/checkup/-/main.go/main\">The main function</a>. This is where it all begins. Like many main functions, ours is simply a wrapper around a method call…</li>\n<li><a href=\"https://sourcegraph.com/github.com/sourcegraph/checkup@d7cd4db3ced36aea99e56f3ed13d877688bff20c/-/def/GoPackage/github.com/sourcegraph/checkup/cmd/-/RootCmd\">RootCmd.Run</a>(). Checkup’s “true” main function. We use spf13’s Cobra library, which lets you define a CLI by creating an instance of the <a href=\"https://sourcegraph.com/github.com/spf13/cobra@9c28e4bbd74e5c3ed7aacbc552b2cab7cfdfe744/-/def/GoPackage/github.com/spf13/cobra/-/Command\">cobra.Command</a> struct.</li>\n<li><a href=\"https://sourcegraph.com/github.com/sourcegraph/checkup@d7cd4db3ced36aea99e56f3ed13d877688bff20c/-/def/GoPackage/github.com/sourcegraph/checkup/-/Checkup\">checkup.Checkup</a> is the type around which everything revolves. It has methods that run the health checks, gather the results, and store the data.</li>\n</ul>\n<p><a href=\"https://sourcegraph.com/github.com/sourcegraph/checkup@d7cd4db3ced36aea99e56f3ed13d877688bff20c/-/def/GoPackage/github.com/sourcegraph/checkup/-/Checkup\"><img src=\"https://cdn-images-1.medium.com/max/800/1*23ZnZM_RcH-yVzI2Fo0BLw.png\"></a></p>\n<ul>\n<li><a href=\"https://sourcegraph.com/github.com/sourcegraph/checkup@d7cd4db3ced36aea99e56f3ed13d877688bff20c/-/def/GoPackage/github.com/sourcegraph/checkup/-/Checkup/Storage\">checkup.Storage</a> is the interface you implement to create a new type of data store (e.g., if you wanted to store the data in Google Object Store instead of S3 or local disk).</li>\n<li><a href=\"https://sourcegraph.com/github.com/sourcegraph/checkup@d7cd4db3ced36aea99e56f3ed13d877688bff20c/-/def/GoPackage/github.com/sourcegraph/checkup/-/Checker\">checkup.Checker</a> is the interface you implement to create a new type of health check.</li>\n</ul>\n<p>We hope you’ll find Checkup useful as a tool and informative as a codebase. Please <a href=\"https://twitter.com/sourcegraph\">send us feedback</a> and let us know how you’re using it!</p>"}